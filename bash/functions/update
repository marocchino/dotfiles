#!/bin/bash

function update-asdf() {
  echo updating asdf
  echo asdf update
  asdf update
  echo asdf plugin-update --all
  asdf plugin-update --all
}

function update-apt-get() {
  echo updating apt-get
  echo sudo apt-get update -y
  sudo apt-get update -y
}

function update-brew() {
  echo updating brew
  echo brew update
  brew update
  echo brew upgrade
  brew upgrade
  echo brew cleanup
  brew cleanup
}

function update-vim() {
  echo updating vim
  echo nvim +PackUpdate +qall
  nvim +PackUpdate +qall
}
function update-yarn() {
  if [[ $VERSION ]]; then
    echo updating yarn to $VERSION
    echo npm install -g "https://yarnpkg.com/downloads/${VERSION}/yarn-v${VERSION}.tar.gz"
    npm install -g "https://yarnpkg.com/downloads/${VERSION}/yarn-v${VERSION}.tar.gz"
  else
    echo updating yarn to latest
    echo npm install -g "https://yarnpkg.com/latest.tar.gz"
    npm install -g "https://yarnpkg.com/latest.tar.gz"
  fi
  echo asdf reshim nodejs
  asdf reshim nodejs
}

function update-npm() {
  echo updating npm
  echo npm i -g npm
  npm i -g npm
}

function update-dotfiles() {
  echo updating dotfiles
  pushd ~/dotfiles || return
  echo git pull
  git pull
  popd || return
}

function update-kuromoji() {
  echo updating kuromoji
  echo brew services stop elasticsearch
  brew services stop elasticsearch
  echo elasticsearch-plugin remove analysis-kuromoji
  elasticsearch-plugin remove analysis-kuromoji
  echo elasticsearch-plugin install analysis-kuromoji
  elasticsearch-plugin install analysis-kuromoji
  echo brew services start elasticsearch
  brew services start elasticsearch
}

function main() {
  case $1 in
  aset)
    update-asdf
    ;;
  asdf)
    update-asdf
    ;;
  apt-get)
    update-apt-get
    ;;
  brew)
    update-brew
    ;;
  dotfiles)
    update-dotfiles
    ;;
  npm)
    update-npm
    ;;
  kuromoji)
    update-kuromoji
    ;;
  vim)
    update-vim
    ;;
  yarn)
    update-yarn
    ;;
  all)
    update-asdf
    update-brew
    update-dotfiles
    update-npm
    update-vim
    ;;
  *)
    echo 'update what?'
    echo 'please select from:
  apt-get, asdf, brew, dotfiles, kuromoji, npm, vim, yarn, all'
    ;;
  esac
}
main "$@"
